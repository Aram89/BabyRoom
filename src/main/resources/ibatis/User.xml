<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="user">
    <typeAlias alias="user" type="org.proffart.babyroom.domain.User" />

    <resultMap id="result" class="user">
        <result property="email" column="email"/>
        <result property="passwordSalt" column="passwordSalt"/>
        <result property="passwordHash" column="passwordHash"/>
    </resultMap>
    <insert id="insert" parameterClass="user">
        INSERT INTO users(email,passwordSalt,passwordHash)
        values (#email#,#passwordSalt#,#passwordHash#)

        <selectKey resultClass="int" keyProperty="id">
            select last_insert_id() as id
        </selectKey>
    </insert>

    <select id="checkEmail" resultClass="int" parameterClass="String">
        SELECT COUNT(*) FROM users
        where email = #email#
    </select>


</sqlMap>